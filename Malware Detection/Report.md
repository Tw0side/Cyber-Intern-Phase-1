## Malware Detection Using VirusTotal Integration with Wazuh

### Abstract

This report outlines the process of integrating VirusTotal with Wazuh for effective malware detection.
By leveraging VirusTotal's extensive database, Wazuh enhances its capability to identify and respond to potential threats across monitored systems.

### Introduction

In today's cybersecurity landscape, proactive malware detection is essential for safeguarding sensitive information.
This integration allows organizations to detect malicious files in real-time, ensuring a robust defense against potential threats.

### Setting Up VirusTotal with Wazuh

1. **Obtain API Key**: Start by visiting the VirusTotal website and acquiring a free API key. This key is necessary for authenticating requests to VirusTotal's service.
2. **Configure Wazuh Server**: On the Wazuh server, edit the `ossec.conf` file to enable the VirusTotal integration. Incorporate the following configuration snippet:

    ```xml
    <ossec_config>
      <integration>
        <name>virustotal</name>
        <api_key><ENTER_YOUR_VIRUSTOTAL_API_KEY></api_key>
        <group>syscheck</group>
        <alert_format>json</alert_format>
      </integration>
    </ossec_config>
    ```

3. **Finalize Server Configuration**: Once the server-side setup is complete, you can proceed to configure the Wazuh agent.

### Configuring the Wazuh Agent

1. **Enable File Integrity Monitoring**: On the endpoint where the Wazuh agent is installed, modify the configuration file to enable real-time file integrity checking. Add the following configuration:

    ```xml
    <syscheck>
      <disabled>no</disabled>
    </syscheck>
    ```

2. **Specify Directories for Monitoring**: Identify the directory that requires real-time monitoring and restart the agent to apply the changes. For example:

    ```xml
    <syscheck>
      <directories realtime="yes">C:\Users\Administrator\Documents</directories>
    </syscheck>
    ```

### Testing the Setup

To validate the configuration, use the EICAR test file, which simulates malware. Place this file in the designated directory.
Following this, monitor the Security Information and Event Management (SIEM) system for alerts. 
An alert indicating the presence of a suspicious file should appear, confirming that the integration is functioning as intended.

### Conclusion

The integration of VirusTotal with Wazuh significantly enhances the malware detection capabilities of the system.
By proactively identifying potentially harmful files, organizations can safeguard their data and minimize security risks.
Proper configuration and testing ensure the effectiveness of this integration in a professional cybersecurity framework. 


